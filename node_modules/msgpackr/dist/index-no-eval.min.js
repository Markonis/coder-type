!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).msgpackr={})}(this,(function(e){"use strict";var t,r,n;try{t=new TextDecoder}catch(e){}var i,s,o,a,u,l=0,c={},f=0,h=0,g=[],p={useRecords:!1,mapsAsObjects:!0};class d{}const y=new d;y.name="MessagePack 0xC1";var w,b=!1,m=2;try{new w("")}catch(e){m=1/0}class S{constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.sequential&&!1!==e.trusted&&(e.trusted=!0,e.structures||0==e.useRecords||(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(r)return q((()=>(J(),this?this.unpack(e,t):S.prototype.unpack.call(p,e,t))));"object"==typeof t?(n=t.end||e.length,l=t.start||0):(l=0,n=t>-1?t:e.length),h=0,s=null,o=null,r=e;try{u=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(t){if(r=null,e instanceof Uint8Array)throw t;throw new Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}if(this instanceof S){if(c=this,this.structures)return i=this.structures,U(t);(!i||i.length>0)&&(i=[])}else c=p,(!i||i.length>0)&&(i=[]);return U(t)}unpackMultiple(e,t){let r,n=0;try{b=!0;let i=e.length,s=this?this.unpack(e,i):H.unpack(e,i);if(!t){for(r=[s];l<i;)n=l,r.push(U());return r}if(!1===t(s))return;for(;l<i;)if(n=l,!1===t(U()))return}catch(e){throw e.lastPosition=n,e.values=r,e}finally{b=!1,J()}}_mergeStructures(e,t){e=e||[],Object.isFrozen(e)&&(e=e.map((e=>e.slice(0))));for(let t=0,r=e.length;t<r;t++){let r=e[t];r&&(r.isShared=!0,t>=32&&(r.highByte=t-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let n=e[r],i=t[r];i&&(n&&((e.restoreStructures||(e.restoreStructures=[]))[r]=n),e[r]=i)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function U(e){try{if(!c.trusted&&!b){let e=i.sharedLength||0;e<i.length&&(i.length=e)}let e;if(c.randomAccessStructure&&r[l]<64&&r[l],e=k(),o&&(l=o.postBundlePosition,o=null),l==n)i&&i.restoreStructures&&A(),i=null,r=null,a&&(a=null);else{if(l>n)throw new Error("Unexpected end of MessagePack data");if(!b)throw new Error("Data read, but end of buffer not reached "+JSON.stringify(e).slice(0,100))}return e}catch(e){throw i&&i.restoreStructures&&A(),J(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||l>n)&&(e.incomplete=!0),e}}function A(){for(let e in i.restoreStructures)i[e]=i.restoreStructures[e];i.restoreStructures=null}function k(){let e=r[l++];if(e<160){if(e<128){if(e<64)return e;{let t=i[63&e]||c.getStructures&&E()[63&e];return t?(t.read||(t.read=v(t,63&e)),t.read()):e}}if(e<144){if(e-=128,c.mapsAsObjects){let t={};for(let r=0;r<e;r++){let e=N();"__proto__"===e&&(e="__proto_"),t[e]=k()}return t}{let t=new Map;for(let r=0;r<e;r++)t.set(k(),k());return t}}{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=k();return c.freezeData?Object.freeze(t):t}}if(e<192){let t=e-160;if(h>=l)return s.slice(l-f,(l+=t)-f);if(0==h&&n<140){let e=t<16?V(t):F(t);if(null!=e)return e}return O(t)}{let t;switch(e){case 192:return null;case 193:return o?(t=k(),t>0?o[1].slice(o.position1,o.position1+=t):o[0].slice(o.position0,o.position0-=t)):y;case 194:return!1;case 195:return!0;case 196:if(t=r[l++],void 0===t)throw new Error("Unexpected end of buffer");return P(t);case 197:return t=u.getUint16(l),l+=2,P(t);case 198:return t=u.getUint32(l),l+=4,P(t);case 199:return C(r[l++]);case 200:return t=u.getUint16(l),l+=2,C(t);case 201:return t=u.getUint32(l),l+=4,C(t);case 202:if(t=u.getFloat32(l),c.useFloat32>2){let e=Z[(127&r[l])<<1|r[l+1]>>7];return l+=4,(e*t+(t>0?.5:-.5)>>0)/e}return l+=4,t;case 203:return t=u.getFloat64(l),l+=8,t;case 204:return r[l++];case 205:return t=u.getUint16(l),l+=2,t;case 206:return t=u.getUint32(l),l+=4,t;case 207:return"number"===c.int64AsType?(t=4294967296*u.getUint32(l),t+=u.getUint32(l+4)):t="string"===c.int64AsType?u.getBigUint64(l).toString():u.getBigUint64(l),l+=8,t;case 208:return u.getInt8(l++);case 209:return t=u.getInt16(l),l+=2,t;case 210:return t=u.getInt32(l),l+=4,t;case 211:return"number"===c.int64AsType?(t=4294967296*u.getInt32(l),t+=u.getUint32(l+4)):t="string"===c.int64AsType?u.getBigInt64(l).toString():u.getBigInt64(l),l+=8,t;case 212:if(t=r[l++],114==t)return W(63&r[l++]);{let e=g[t];if(e)return e.read?(l++,e.read(k())):e.noBuffer?(l++,e()):e(r.subarray(l,++l));throw new Error("Unknown extension "+t)}case 213:return t=r[l],114==t?(l++,W(63&r[l++],r[l++])):C(2);case 214:return C(4);case 215:return C(8);case 216:return C(16);case 217:return t=r[l++],h>=l?s.slice(l-f,(l+=t)-f):x(t);case 218:return t=u.getUint16(l),h>=(l+=2)?s.slice(l-f,(l+=t)-f):B(t);case 219:return t=u.getUint32(l),h>=(l+=4)?s.slice(l-f,(l+=t)-f):M(t);case 220:return t=u.getUint16(l),l+=2,j(t);case 221:return t=u.getUint32(l),l+=4,j(t);case 222:return t=u.getUint16(l),l+=2,D(t);case 223:return t=u.getUint32(l),l+=4,D(t);default:if(e>=224)return e-256;if(void 0===e){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw new Error("Unknown MessagePack token "+e)}}}const I=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function v(e,t){function r(){if(r.count++>m){let r=e.read=new w("r","return function(){return "+(c.freezeData?"Object.freeze":"")+"({"+e.map((e=>"__proto__"===e?"__proto_:r()":I.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()")).join(",")+"})}")(k);return 0===e.highByte&&(e.read=_(t,e.read)),r()}let n={};for(let t=0,r=e.length;t<r;t++){let r=e[t];"__proto__"===r&&(r="__proto_"),n[r]=k()}return c.freezeData?Object.freeze(n):n}return r.count=0,0===e.highByte?_(t,r):r}const _=(e,t)=>function(){let n=r[l++];if(0===n)return t();let s=e<32?-(e+(n<<5)):e+(n<<5),o=i[s]||E()[s];if(!o)throw new Error("Record id is not defined for "+s);return o.read||(o.read=v(o,e)),o.read()};function E(){let e=q((()=>(r=null,c.getStructures())));return i=c._mergeStructures(e,i)}var O=T,x=T,B=T,M=T;function T(e){let n;if(e<16&&(n=V(e)))return n;if(e>64&&t)return t.decode(r.subarray(l,l+=e));const i=l+e,s=[];for(n="";l<i;){const e=r[l++];if(0==(128&e))s.push(e);else if(192==(224&e)){const t=63&r[l++];s.push((31&e)<<6|t)}else if(224==(240&e)){const t=63&r[l++],n=63&r[l++];s.push((31&e)<<12|t<<6|n)}else if(240==(248&e)){let t=(7&e)<<18|(63&r[l++])<<12|(63&r[l++])<<6|63&r[l++];t>65535&&(t-=65536,s.push(t>>>10&1023|55296),t=56320|1023&t),s.push(t)}else s.push(e);s.length>=4096&&(n+=L.apply(String,s),s.length=0)}return s.length>0&&(n+=L.apply(String,s)),n}function j(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=k();return c.freezeData?Object.freeze(t):t}function D(e){if(c.mapsAsObjects){let t={};for(let r=0;r<e;r++){let e=N();"__proto__"===e&&(e="__proto_"),t[e]=k()}return t}{let t=new Map;for(let r=0;r<e;r++)t.set(k(),k());return t}}var L=String.fromCharCode;function F(e){let t=l,n=new Array(e);for(let i=0;i<e;i++){const e=r[l++];if((128&e)>0)return void(l=t);n[i]=e}return L.apply(String,n)}function V(e){if(e<4){if(e<2){if(0===e)return"";{let e=r[l++];return(128&e)>1?void(l-=1):L(e)}}{let t=r[l++],n=r[l++];if((128&t)>0||(128&n)>0)return void(l-=2);if(e<3)return L(t,n);let i=r[l++];return(128&i)>0?void(l-=3):L(t,n,i)}}{let t=r[l++],n=r[l++],i=r[l++],s=r[l++];if((128&t)>0||(128&n)>0||(128&i)>0||(128&s)>0)return void(l-=4);if(e<6){if(4===e)return L(t,n,i,s);{let e=r[l++];return(128&e)>0?void(l-=5):L(t,n,i,s,e)}}if(e<8){let o=r[l++],a=r[l++];if((128&o)>0||(128&a)>0)return void(l-=6);if(e<7)return L(t,n,i,s,o,a);let u=r[l++];return(128&u)>0?void(l-=7):L(t,n,i,s,o,a,u)}{let o=r[l++],a=r[l++],u=r[l++],c=r[l++];if((128&o)>0||(128&a)>0||(128&u)>0||(128&c)>0)return void(l-=8);if(e<10){if(8===e)return L(t,n,i,s,o,a,u,c);{let e=r[l++];return(128&e)>0?void(l-=9):L(t,n,i,s,o,a,u,c,e)}}if(e<12){let f=r[l++],h=r[l++];if((128&f)>0||(128&h)>0)return void(l-=10);if(e<11)return L(t,n,i,s,o,a,u,c,f,h);let g=r[l++];return(128&g)>0?void(l-=11):L(t,n,i,s,o,a,u,c,f,h,g)}{let f=r[l++],h=r[l++],g=r[l++],p=r[l++];if((128&f)>0||(128&h)>0||(128&g)>0||(128&p)>0)return void(l-=12);if(e<14){if(12===e)return L(t,n,i,s,o,a,u,c,f,h,g,p);{let e=r[l++];return(128&e)>0?void(l-=13):L(t,n,i,s,o,a,u,c,f,h,g,p,e)}}{let d=r[l++],y=r[l++];if((128&d)>0||(128&y)>0)return void(l-=14);if(e<15)return L(t,n,i,s,o,a,u,c,f,h,g,p,d,y);let w=r[l++];return(128&w)>0?void(l-=15):L(t,n,i,s,o,a,u,c,f,h,g,p,d,y,w)}}}}}function R(){let e,t=r[l++];if(t<192)e=t-160;else switch(t){case 217:e=r[l++];break;case 218:e=u.getUint16(l),l+=2;break;case 219:e=u.getUint32(l),l+=4;break;default:throw new Error("Expected string")}return T(e)}function P(e){return c.copyBuffers?Uint8Array.prototype.slice.call(r,l,l+=e):r.subarray(l,l+=e)}function C(e){let t=r[l++];if(g[t]){let n;return g[t](r.subarray(l,n=l+=e),(e=>{l=e;try{return k()}finally{l=n}}))}throw new Error("Unknown extension type "+t)}var z=new Array(4096);function N(){let e=r[l++];if(!(e>=160&&e<192))return l--,k().toString();if(e-=160,h>=l)return s.slice(l-f,(l+=e)-f);if(!(0==h&&n<180))return O(e);let t,i=4095&(e<<5^(e>1?u.getUint16(l):e>0?r[l]:0)),o=z[i],a=l,c=l+e-3,g=0;if(o&&o.bytes==e){for(;a<c;){if(t=u.getUint32(a),t!=o[g++]){a=1879048192;break}a+=4}for(c+=3;a<c;)if(t=r[a++],t!=o[g++]){a=1879048192;break}if(a===c)return l=a,o.string;c-=3,a=l}for(o=[],z[i]=o,o.bytes=e;a<c;)t=u.getUint32(a),o.push(t),a+=4;for(c+=3;a<c;)t=r[a++],o.push(t);let p=e<16?V(e):F(e);return o.string=null!=p?p:O(e)}const W=(e,t)=>{let r=k().map((e=>e.toString())),n=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let s=i[e];return s&&s.isShared&&((i.restoreStructures||(i.restoreStructures=[]))[e]=s),i[e]=r,r.read=v(r,n),r.read()};g[0]=()=>{},g[0].noBuffer=!0,g[101]=()=>{let e=k();return(globalThis[e[0]]||Error)(e[1])},g[105]=e=>{let t=u.getUint32(l-4);a||(a=new Map);let n,i=r[l];n=i>=144&&i<160||220==i||221==i?[]:{};let s={target:n};a.set(t,s);let o=k();return s.used?Object.assign(n,o):(s.target=o,o)},g[112]=e=>{let t=u.getUint32(l-4),r=a.get(t);return r.used=!0,r.target},g[115]=()=>new Set(k());const Y=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((e=>e+"Array"));g[116]=e=>{let t=e[0],r=Y[t];if(!r)throw new Error("Could not find typed array for code "+t);return new globalThis[r](Uint8Array.prototype.slice.call(e,1).buffer)},g[120]=()=>{let e=k();return new RegExp(e[0],e[1])};const $=[];function q(e){let t=n,g=l,p=f,d=h,y=s,w=a,m=o,S=new Uint8Array(r.slice(0,n)),U=i,A=i.slice(0,i.length),k=c,I=b,v=e();return n=t,l=g,f=p,h=d,s=y,a=w,o=m,r=S,b=I,(i=U).splice(0,i.length,...A),c=k,u=new DataView(r.buffer,r.byteOffset,r.byteLength),v}function J(){r=null,a=null,i=null}g[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=l;return l+=t-e.length,o=$,(o=[R(),R()]).position0=0,o.position1=0,o.postBundlePosition=l,l=r,k()},g[255]=e=>4==e.length?new Date(1e3*(16777216*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+1e3*(4294967296*(3&e[3])+16777216*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+1e3*((128&e[4]?-281474976710656:0)+1099511627776*e[6]+4294967296*e[7]+16777216*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])):new Date("invalid");const Z=new Array(147);for(let e=0;e<256;e++)Z[e]=+("1e"+Math.floor(45.15-.30103*e));const G=S;var H=new S({useRecords:!1});const K=H.unpack,Q=H.unpackMultiple,X=H.unpack,ee={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4};let te,re,ne,ie=new Float32Array(1),se=new Uint8Array(ie.buffer,0,4);try{te=new TextEncoder}catch(e){}const oe="undefined"!=typeof Buffer,ae=oe?function(e){return Buffer.allocUnsafeSlow(e)}:Uint8Array,ue=oe?Buffer:Uint8Array,le=oe?4294967296:2144337920;let ce,fe,he,ge,pe=0,de=null;const ye=/[\u0080-\uFFFF]/,we=Symbol("record-id");class be extends S{constructor(e){let t,r,n,i;super(e),this.offset=0;let s=ue.prototype.utf8Write?function(e,t){return ce.utf8Write(e,t,4294967295)}:!(!te||!te.encodeInto)&&function(e,t){return te.encodeInto(e,ce.subarray(t)).written},o=this;e||(e={});let a=e&&e.sequential,u=e.structures||e.saveStructures,l=e.maxSharedStructures;if(null==l&&(l=u?32:0),l>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&null==e.moreTypes&&(this.moreTypes=!0);let c=e.maxOwnStructures;null==c&&(c=u?32:64),this.structures||0==e.useRecords||(this.structures=[]);let f=l>32||c+l>64,h=l+64,g=l+c+64;if(g>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let p=[],d=0,y=0;this.pack=this.encode=function(e,s){if(ce||(ce=new ae(8192),he=ce.dataView||(ce.dataView=new DataView(ce.buffer,0,8192)),pe=0),ge=ce.length-10,ge-pe<2048?(ce=new ae(ce.length),he=ce.dataView||(ce.dataView=new DataView(ce.buffer,0,ce.length)),ge=ce.length-10,pe=0):pe=pe+7&2147483640,t=pe,i=o.structuredClone?new Map:null,o.bundleStrings&&"string"!=typeof e?(de=[],de.size=1/0):de=null,n=o.structures,n){n.uninitialized&&(n=o._mergeStructures(o.getStructures()));let e=n.sharedLength||0;if(e>l)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let t=0;t<e;t++){let e=n[t];if(!e)continue;let r,i=n.transitions;for(let t=0,n=e.length;t<n;t++){let n=e[t];r=i[n],r||(r=i[n]=Object.create(null)),i=r}i[we]=t+64}this.lastNamedStructuresLength=e}a||(n.nextId=e+64)}r&&(r=!1);try{o.randomAccessStructure&&e.constructor&&e.constructor===Object?k(e):b(e);let u=de;if(de&&Ae(t,b,0),i&&i.idsToInsert){let e=i.idsToInsert.sort(((e,t)=>e.offset>t.offset?1:-1)),r=e.length,n=-1;for(;u&&r>0;){let i=e[--r].offset+t;i<u.stringsPosition+t&&-1===n&&(n=0),i>u.position+t?n>=0&&(n+=6):(n>=0&&(he.setUint32(u.position+t,he.getUint32(u.position+t)+n),n=-1),u=u.previous,r++)}n>=0&&u&&he.setUint32(u.position+t,he.getUint32(u.position+t)+n),pe+=6*e.length,pe>ge&&S(pe),o.offset=pe;let s=function(e,t){let r,n=6*t.length,i=e.length-n;for(;r=t.pop();){let t=r.offset,s=r.id;e.copyWithin(t+n,t,i),n-=6;let o=t+n;e[o++]=214,e[o++]=105,e[o++]=s>>24,e[o++]=s>>16&255,e[o++]=s>>8&255,e[o++]=255&s,i=t}return e}(ce.subarray(t,pe),e);return i=null,s}return o.offset=pe,s&Me?(ce.start=t,ce.end=pe,ce):ce.subarray(t,pe)}finally{if(n){y<10&&y++;let i=n.sharedLength||0;if(n.length>i&&(n.length=i),d>1e4)n.transitions=null,y=0,d=0,p.length>0&&(p=[]);else if(p.length>0&&!a){for(let e=0,t=p.length;e<t;e++)p[e][we]=0;p=[]}if(r&&o.saveStructures){let r=ce.subarray(t,pe),s=function(e,t){return e.isCompatible=e=>{let r=!e||(t.lastNamedStructuresLength||0)===e.length;return r||t._mergeStructures(e),r},e}(n,o);return!1===o.saveStructures(s,s.isCompatible)?o.pack(e):(o.lastNamedStructuresLength=i,r)}}s&Te&&(pe=t)}};const w=e=>{var t=e.length;t<16?ce[pe++]=144|t:t<65536?(ce[pe++]=220,ce[pe++]=t>>8,ce[pe++]=255&t):(ce[pe++]=221,he.setUint32(pe,t),pe+=4);for(let r=0;r<t;r++)b(e[r])},b=e=>{pe>ge&&(ce=S(pe));var r,n=typeof e;if("string"===n){let n,i=e.length;if(de&&i>=4&&i<4096){if((de.size+=i)>21760){let e,r,n=(de[0]?3*de[0].length+de[1].length:0)+10;pe+n>ge&&(ce=S(pe+n)),de.position?(r=de,ce[pe]=200,pe+=3,ce[pe++]=98,e=pe-t,pe+=4,Ae(t,b,0),he.setUint16(e+t-3,pe-t-e)):(ce[pe++]=214,ce[pe++]=98,e=pe-t,pe+=4),de=["",""],de.previous=r,de.size=0,de.position=e}let r=ye.test(e);return de[r?0:1]+=e,ce[pe++]=193,void b(r?-i:i)}n=i<32?1:i<256?2:i<65536?3:5;let o=3*i;if(pe+o>ge&&(ce=S(pe+o)),i<64||!s){let t,s,o,a=pe+n;for(t=0;t<i;t++)s=e.charCodeAt(t),s<128?ce[a++]=s:s<2048?(ce[a++]=s>>6|192,ce[a++]=63&s|128):55296==(64512&s)&&56320==(64512&(o=e.charCodeAt(t+1)))?(s=65536+((1023&s)<<10)+(1023&o),t++,ce[a++]=s>>18|240,ce[a++]=s>>12&63|128,ce[a++]=s>>6&63|128,ce[a++]=63&s|128):(ce[a++]=s>>12|224,ce[a++]=s>>6&63|128,ce[a++]=63&s|128);r=a-pe-n}else r=s(e,pe+n);r<32?ce[pe++]=160|r:r<256?(n<2&&ce.copyWithin(pe+2,pe+1,pe+1+r),ce[pe++]=217,ce[pe++]=r):r<65536?(n<3&&ce.copyWithin(pe+3,pe+2,pe+2+r),ce[pe++]=218,ce[pe++]=r>>8,ce[pe++]=255&r):(n<5&&ce.copyWithin(pe+5,pe+3,pe+3+r),ce[pe++]=219,he.setUint32(pe,r),pe+=4),pe+=r}else if("number"===n)if(e>>>0===e)e<32||e<128&&!1===this.useRecords||e<64&&!this.randomAccessStructure?ce[pe++]=e:e<256?(ce[pe++]=204,ce[pe++]=e):e<65536?(ce[pe++]=205,ce[pe++]=e>>8,ce[pe++]=255&e):(ce[pe++]=206,he.setUint32(pe,e),pe+=4);else if(e>>0===e)e>=-32?ce[pe++]=256+e:e>=-128?(ce[pe++]=208,ce[pe++]=e+256):e>=-32768?(ce[pe++]=209,he.setInt16(pe,e),pe+=2):(ce[pe++]=210,he.setInt32(pe,e),pe+=4);else{let t;if((t=this.useFloat32)>0&&e<4294967296&&e>=-2147483648){let r;if(ce[pe++]=202,he.setFloat32(pe,e),t<4||(r=e*Z[(127&ce[pe])<<1|ce[pe+1]>>7])>>0===r)return void(pe+=4);pe--}ce[pe++]=203,he.setFloat64(pe,e),pe+=8}else if("object"===n)if(e){if(i){let r=i.get(e);if(r){if(!r.id){let e=i.idsToInsert||(i.idsToInsert=[]);r.id=e.push(r)}return ce[pe++]=214,ce[pe++]=112,he.setUint32(pe,r.id),void(pe+=4)}i.set(e,{offset:pe-t})}let n=e.constructor;if(n===Object)m(e,!0);else if(n===Array)w(e);else if(n===Map){(r=e.size)<16?ce[pe++]=128|r:r<65536?(ce[pe++]=222,ce[pe++]=r>>8,ce[pe++]=255&r):(ce[pe++]=223,he.setUint32(pe,r),pe+=4);for(let[t,r]of e)b(t),b(r)}else{for(let t=0,r=re.length;t<r;t++){if(e instanceof ne[t]){let r=re[t];if(r.write){r.type&&(ce[pe++]=212,ce[pe++]=r.type,ce[pe++]=0);let t=r.write.call(this,e);return void(t===e?Array.isArray(e)?w(e):m(e):b(t))}let n,i=ce,s=he,o=pe;ce=null;try{n=r.pack.call(this,e,(e=>(ce=i,i=null,pe+=e,pe>ge&&S(pe),{target:ce,targetView:he,position:pe-e})),b)}finally{i&&(ce=i,he=s,pe=o,ge=ce.length-10)}return void(n&&(n.length+pe>ge&&S(n.length+pe),pe=Ue(n,ce,pe,r.type)))}}Array.isArray(e)?w(e):m(e,!e.hasOwnProperty)}}else ce[pe++]=192;else if("boolean"===n)ce[pe++]=e?195:194;else if("bigint"===n){if(e<BigInt(1)<<BigInt(63)&&e>=-(BigInt(1)<<BigInt(63)))ce[pe++]=211,he.setBigInt64(pe,e);else if(e<BigInt(1)<<BigInt(64)&&e>0)ce[pe++]=207,he.setBigUint64(pe,e);else{if(!this.largeBigIntToFloat)throw new RangeError(e+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");ce[pe++]=203,he.setFloat64(pe,Number(e))}pe+=8}else if("undefined"===n)this.encodeUndefinedAsNil?ce[pe++]=192:(ce[pe++]=212,ce[pe++]=0,ce[pe++]=0);else{if("function"!==n)throw new Error("Unknown type: "+n);b(this.writeFunction&&this.writeFunction())}},m=!1===this.useRecords?this.variableMapSize?e=>{let t,r=Object.keys(e),n=r.length;n<16?ce[pe++]=128|n:n<65536?(ce[pe++]=222,ce[pe++]=n>>8,ce[pe++]=255&n):(ce[pe++]=223,he.setUint32(pe,n),pe+=4);for(let i=0;i<n;i++)b(t=r[i]),b(e[t])}:(e,r)=>{ce[pe++]=222;let n=pe-t;pe+=2;let i=0;for(let t in e)(r||e.hasOwnProperty(t))&&(b(t),b(e[t]),i++);ce[n+++t]=i>>8,ce[n+t]=255&i}:e.progressiveRecords&&!f?(e,r)=>{let i,s,o=n.transitions||(n.transitions=Object.create(null)),a=pe++-t;for(let u in e)if(r||e.hasOwnProperty(u)){if(i=o[u],i)o=i;else{let r=Object.keys(e),l=o;o=n.transitions;let c=0;for(let e=0,t=r.length;e<t;e++){let t=r[e];i=o[t],i||(i=o[t]=Object.create(null),c++),o=i}a+t+1==pe?(pe--,U(o,r,c)):A(o,r,a,c),s=!0,o=l[u]}b(e[u])}if(!s){let r=o[we];r?ce[a+t]=r:A(o,Object.keys(e),a,0)}}:(e,t)=>{let r,i=n.transitions||(n.transitions=Object.create(null)),s=0;for(let n in e)(t||e.hasOwnProperty(n))&&(r=i[n],r||(r=i[n]=Object.create(null),s++),i=r);let o=i[we];o?o>=96&&f?(ce[pe++]=96+(31&(o-=96)),ce[pe++]=o>>5):ce[pe++]=o:U(i,i.__keys__||Object.keys(e),s);for(let r in e)(t||e.hasOwnProperty(r))&&b(e[r])},S=e=>{let r;if(e>16777216){if(e-t>le)throw new Error("Packed buffer would be larger than maximum buffer size");r=Math.min(le,4096*Math.round(Math.max((e-t)*(e>67108864?1.25:2),4194304)/4096))}else r=1+(Math.max(e-t<<2,ce.length-1)>>12)<<12;let n=new ae(r);return he=n.dataView||(n.dataView=new DataView(n.buffer,0,r)),e=Math.min(e,ce.length),ce.copy?ce.copy(n,0,t,e):n.set(ce.slice(t,e)),pe-=t,t=0,ge=n.length-10,ce=n},U=(e,t,i)=>{let s=n.nextId;s||(s=64),s<h&&this.shouldShareStructure&&!this.shouldShareStructure(t)?(s=n.nextOwnId,s<g||(s=h),n.nextOwnId=s+1):(s>=g&&(s=h),n.nextId=s+1);let o=t.highByte=s>=96&&f?s-96>>5:-1;e[we]=s,e.__keys__=t,n[s-64]=t,s<h?(t.isShared=!0,n.sharedLength=s-63,r=!0,o>=0?(ce[pe++]=96+(31&s),ce[pe++]=o):ce[pe++]=s):(o>=0?(ce[pe++]=213,ce[pe++]=114,ce[pe++]=96+(31&s),ce[pe++]=o):(ce[pe++]=212,ce[pe++]=114,ce[pe++]=s),i&&(d+=y*i),p.length>=c&&(p.shift()[we]=0),p.push(e),b(t))},A=(e,r,n,i)=>{let s=ce,o=pe,a=ge,u=t;ce=fe,pe=0,t=0,ce||(fe=ce=new ae(8192)),ge=ce.length-10,U(e,r,i),fe=ce;let l=pe;if(ce=s,pe=o,ge=a,t=u,l>1){let e=pe+l-1;e>ge&&S(e);let r=n+t;ce.copyWithin(r+l,r+1,pe),ce.set(fe.slice(0,l),r),pe=e}else ce[n+t]=fe[0]},k=(e,t)=>{let i=undefined(e,ce,pe,n,S,((e,t,n)=>{if(n)return r=!0;pe=t;let i=ce;return b(e),i!==ce?{position:pe,targetView:he,target:ce}:pe}),this);if(0===i)return m(e,!0);pe=i}}useBuffer(e){ce=e,he=new DataView(ce.buffer,ce.byteOffset,ce.byteLength),pe=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}function me(e,t,r,n){let i=e.byteLength;if(i+1<256){var{target:s,position:o}=r(4+i);s[o++]=199,s[o++]=i+1}else if(i+1<65536){var{target:s,position:o}=r(5+i);s[o++]=200,s[o++]=i+1>>8,s[o++]=i+1&255}else{var{target:s,position:o,targetView:a}=r(7+i);s[o++]=201,a.setUint32(o,i+1),o+=4}s[o++]=116,s[o++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o)}function Se(e,t){let r=e.byteLength;var n,i;if(r<256){var{target:n,position:i}=t(r+2);n[i++]=196,n[i++]=r}else if(r<65536){var{target:n,position:i}=t(r+3);n[i++]=197,n[i++]=r>>8,n[i++]=255&r}else{var{target:n,position:i,targetView:s}=t(r+5);n[i++]=198,s.setUint32(i,r),i+=4}n.set(e,i)}function Ue(e,t,r,n){let i=e.length;switch(i){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:i<256?(t[r++]=199,t[r++]=i):i<65536?(t[r++]=200,t[r++]=i>>8,t[r++]=255&i):(t[r++]=201,t[r++]=i>>24,t[r++]=i>>16&255,t[r++]=i>>8&255,t[r++]=255&i)}return t[r++]=n,t.set(e,r),r+=i}function Ae(e,t,r){if(de.length>0){he.setUint32(de.position+e,pe+r-de.position-e),de.stringsPosition=pe-e;let n=de;de=null,t(n[0]),t(n[1])}}ne=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,d],re=[{pack(e,t,r){let n=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&n>=0&&n<4294967296){let{target:e,targetView:r,position:i}=t(6);e[i++]=214,e[i++]=255,r.setUint32(i,n)}else if(n>0&&n<4294967296){let{target:r,targetView:i,position:s}=t(10);r[s++]=215,r[s++]=255,i.setUint32(s,4e6*e.getMilliseconds()+(n/1e3/4294967296>>0)),i.setUint32(s+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:e,targetView:n,position:i}=t(3);e[i++]=212,e[i++]=255,e[i++]=255}else{let{target:r,targetView:i,position:s}=t(15);r[s++]=199,r[s++]=12,r[s++]=255,i.setUint32(s,1e6*e.getMilliseconds()),i.setBigInt64(s+4,BigInt(Math.floor(n)))}}},{pack(e,t,r){let n=Array.from(e),{target:i,position:s}=t(this.moreTypes?3:0);this.moreTypes&&(i[s++]=212,i[s++]=115,i[s++]=0),r(n)}},{pack(e,t,r){let{target:n,position:i}=t(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=101,n[i++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:n,position:i}=t(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=120,n[i++]=0),r([e.source,e.flags])}},{pack(e,t){this.moreTypes?me(e,16,t):Se(oe?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==ue&&this.moreTypes?me(e,Y.indexOf(r.name),t):Se(e,t)}},{pack(e,t){let{target:r,position:n}=t(1);r[n]=193}}];let ke=new be({useRecords:!1});const Ie=ke.pack,ve=ke.pack,_e=be,{NEVER:Ee,ALWAYS:Oe,DECIMAL_ROUND:xe,DECIMAL_FIT:Be}=ee,Me=512,Te=1024;const je=function(e,t={}){if(!e||"object"!=typeof e)throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise");const r=new S(t);let n;const i=e=>{let t;n&&(e=Buffer.concat([n,e]),n=void 0);try{t=r.unpackMultiple(e)}catch(r){if(!r.incomplete)throw r;n=e.slice(r.lastPosition),t=r.values}return t};return"function"==typeof e[Symbol.iterator]?function*(){for(const t of e)yield*i(t)}():"function"==typeof e[Symbol.asyncIterator]?async function*(){for await(const t of e)yield*i(t)}():void 0},De=function(e,t={}){if(e&&"object"==typeof e){if("function"==typeof e[Symbol.iterator])return function*(e,t){const r=new be(t);for(const t of e)yield r.pack(t)}(e,t);if("function"==typeof e.then||"function"==typeof e[Symbol.asyncIterator])return async function*(e,t){const r=new be(t);for await(const t of e)yield r.pack(t)}(e,t);throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise")}throw new Error("first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable")};e.ALWAYS=Oe,e.C1=y,e.DECIMAL_FIT=Be,e.DECIMAL_ROUND=xe,e.Decoder=G,e.Encoder=_e,e.FLOAT32_OPTIONS=ee,e.NEVER=Ee,e.Packr=be,e.REUSE_BUFFER_MODE=Me,e.Unpackr=S,e.addExtension=function(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");ne.unshift(e.Class),re.unshift(e)}!function(e){e.unpack?g[e.type]=e.unpack:g[e.type]=e}(e)},e.clearSource=J,e.decode=X,e.decodeIter=je,e.encode=ve,e.encodeIter=De,e.isNativeAccelerationEnabled=!1,e.mapsAsObjects=!0,e.pack=Ie,e.roundFloat32=function(e){ie[0]=e;let t=Z[(127&se[3])<<1|se[2]>>7];return(t*e+(e>0?.5:-.5)>>0)/t},e.unpack=K,e.unpackMultiple=Q,e.useRecords=!1}));
//# sourceMappingURL=index-no-eval.min.js.map
